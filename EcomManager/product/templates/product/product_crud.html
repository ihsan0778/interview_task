<!-- product_crud.html -->

<h1>Product CRUD Operations</h1>

<button onclick="showList()">List Products</button>
<button onclick="showCreateForm()">Add Product</button>
<button onclick="showUpdateForm()">Update Product</button>
<button onclick="showDeleteForm()">Delete Product</button>

<div id="product-list" style="display: none">
  <!-- Include code for listing products -->
  <ul>
    <!-- Example list item -->
    <li>Product 1</li>
    <li>Product 2</li>
    <li>Product 3</li>
  </ul>
</div>

<div id="product-form" style="display: none">
  <!-- Include code for adding/updating/deleting forms -->
  <form id="add-product-form" method="post">
    {% csrf_token %}
    <!-- Form fields for adding a product -->
    <input type="text" name="name" placeholder="Product Name" />
    <input type="number" name="price" placeholder="Price" />
    <button type="submit">Add Product</button>
  </form>

  <form id="update-product-form" method="post">
    {% csrf_token %}
    <!-- Form fields for updating a product -->
    <input type="text" name="name" placeholder="New Product Name" />
    <input type="number" name="price" placeholder="New Price" />
    <button type="submit">Update Product</button>
  </form>

  <form id="delete-product-form" method="post">
    {% csrf_token %}
    <!-- Form fields for deleting a product -->
    <input type="text" name="name" placeholder="Product Name to Delete" />
    <button type="submit">Delete Product</button>
  </form>
</div>

<script>
  function showList() {
    document.getElementById("product-list").style.display = "block";
    document.getElementById("product-form").style.display = "none";
  }

  function showCreateForm() {
    document.getElementById("product-list").style.display = "none";
    document.getElementById("product-form").style.display = "block";
    document.getElementById("add-product-form").style.display = "block";
    document.getElementById("update-product-form").style.display = "none";
    document.getElementById("delete-product-form").style.display = "none";
  }

  function showUpdateForm() {
    document.getElementById("product-list").style.display = "none";
    document.getElementById("product-form").style.display = "block";
    document.getElementById("add-product-form").style.display = "none";
    document.getElementById("update-product-form").style.display = "block";
    document.getElementById("delete-product-form").style.display = "none";
  }

  function showDeleteForm() {
    document.getElementById("product-list").style.display = "none";
    document.getElementById("product-form").style.display = "block";
    document.getElementById("add-product-form").style.display = "none";
    document.getElementById("update-product-form").style.display = "none";
    document.getElementById("delete-product-form").style.display = "block";
  }
  function submitForm(event, action) {
    event.preventDefault(); // Prevent the form from submitting in the traditional way

    // Determine which form was submitted based on 'action'
    let form;
    if (action === "add") {
      form = document.getElementById("add-product-form");
    } else if (action === "update") {
      form = document.getElementById("update-product-form");
    } else if (action === "delete") {
      form = document.getElementById("delete-product-form");
    } else {
      return; // Handle error case where action is not recognized
    }

    // Fetch the form data
    const formData = new FormData(form);

    // Send form data using AJAX (Example using fetch API)
    fetch(form.action, {
      method: "POST",
      body: formData,
      headers: {
        "X-CSRFToken": "{{ csrf_token }}",
      },
    })
      .then((response) => {
        if (!response.ok) {
          throw new Error("Network response was not ok");
        }
        return response.json(); // Assuming response is JSON
      })
      .then((data) => {
        // Handle successful response, update UI as needed
        console.log("Success:", data);
      })
      .catch((error) => {
        console.error("Error:", error);
        // Handle error scenarios, update UI as needed
      });
  }
</script>
